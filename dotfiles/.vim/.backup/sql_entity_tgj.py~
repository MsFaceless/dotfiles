# -*- coding: utf-8 -*-

import os
from datetime import datetime
from hashlib import sha256

from sqlalchemy import Table, ForeignKey, Column
from sqlalchemy.types import Unicode, Integer, DateTime, Boolean
from sqlalchemy.orm import relation, synonym

from rocket.model import DeclarativeBase, metadata, DBSession
from rocket.lib.model_utils import PhatBase, common_columns, get_phat_table, get_type_table

# ********************* Entity Types ***********************************#

EntityType = get_type_table(model_name='Entity', table_name='entity')
OrganisationType = get_type_table(model_name='Organisation', table_name='organisation')
EntityOrganisationType = get_type_table(model_name='EntityOrganisation', table_name='entity_organisation')
EntityOrganisationContactType = get_type_table(model_name='EntityOrganisationContact', table_name='entity_organisation_contact')
EntityOrganisationAddressType = get_type_table(model_name='EntityOrganisationAddress', table_name='entity_organisation_address')

# ********************* Entity Note ***********************************#
columns_tbl_entity_note = {
    '__tablename__': 'tbl_entity_note',
    'entity_id': common_columns.get('integer_not_nullable')(),
    'text': common_columns.get('longtext_not_nullable')(),
}
EntityNote = get_phat_table(model_name='EntityNote', columndict=columns_tbl_entity_note)

# ********************* Person Relationship ***************************#
columns_tbl_person_relationship_link = {
    '__tablename__': 'tbl_person_relationship_link',
    'person_id': common_columns.get('integer_not_nullable')(),
    'person_id_relation': common_columns.get('integer_not_nullable')(),
    'relationship_type_id': common_columns.get('integer_not_nullable')(),
}
PersonRelationshipLink = get_phat_table(model_name='PersonRelationshipLink', columndict=columns_tbl_person_relationship_link)

# ********************* Organisation *****************************#
columns_tbl_organisation_type_link = {
    '__tablename__': 'tbl_organisation_type_link',
    'organisation_id': common_columns.get('integer_not_nullable')(),
    'organisation_type_id': common_columns.get('integer_not_nullable')(),
}
OrganisationTypeLink = get_phat_table(model_name='OrganisationTypeLink', columndict=columns_tbl_organisation_type_link)

# ********************* Branch *****************************#
columns_tbl_organisation_branch_link = {
    '__tablename__': 'tbl_organisation_branch_link',
    'organisation_id': common_columns.get('integer_not_nullable')(),
    'organisation_id_branch': common_columns.get('integer_not_nullable')(),
}
OrganisationBranchLink = get_phat_table(model_name='OrganisationBranchLink', columndict=columns_tbl_organisation_branch_link)

columns_tbl_organisation_branch_user_link = {
    '__tablename__': 'tbl_organisation_branch_user_link',
    'organisation_branch_link_id': common_columns.get('integer_not_nullable')(),
    'tg_user_id': common_columns.get('integer_not_nullable')(),
}
OrganisationBranchUserLink = get_phat_table(model_name='OrganisationBranchUserLink', columndict=columns_tbl_organisation_branch_user_link)

#********************* Product Owner *****************************#
columns_tbl_organisation_product_owner = {
    '__tablename__': 'tbl_organisation_product_owner',
    'organisation_id': common_columns.get('integer_not_nullable')(),
    'policy_number_prefix': common_columns.get('title_not_nullable')(),
}
OrganisationProductOwner = get_phat_table(model_name='OrganisationProductOwner', columndict=columns_tbl_organisation_product_owner)

# ********************* Payment Provider *****************************#
columns_tbl_organisation_payment_provider = {
    '__tablename__': 'tbl_organisation_payment_provider',
    'organisation_id': common_columns.get('integer_not_nullable')(),
    'reference_number': common_columns.get('description_not_nullable')(),
}
OrganisationPaymentProvider = get_phat_table(model_name='OrganisationPaymentProvider', columndict=columns_tbl_organisation_payment_provider)

# ********************* Service Provider *****************************#
columns_tbl_organisation_service_provider = {
    '__tablename__': 'tbl_organisation_service_provider',
    'organisation_id': common_columns.get('integer_not_nullable')(),
    'service_provider_category_id': common_columns.get('integer_not_nullable')(),
    'sub_category_id': common_columns.get('integer_not_nullable')(),
}
OrganisationServiceProvider = get_phat_table(model_name='OrganisationServiceProvider', columndict=columns_tbl_organisation_service_provider)

columns_tbl_service_provider_category = {
    '__tablename__': 'tbl_service_provider_category',
    'name': common_columns.get('description_not_nullable')(),
    'description': common_columns.get('description_not_nullable')(),
}
ServiceProviderCategory = get_phat_table(model_name='ServiceProviderCategory', columndict=columns_tbl_service_provider_category)

columns_tbl_service_provider_subcategory = {
    '__tablename__': 'tbl_service_provider_subcategory',
    'service_provider_category_id': common_columns.get('integer_not_nullable')(),
    'name': common_columns.get('description_not_nullable')(),
    'description': common_columns.get('description_not_nullable')(),
}
ServiceProviderSubcategory = get_phat_table(model_name='ServiceProviderSubcategory', columndict=columns_tbl_service_provider_subcategory)

# ********************* Intermediary *****************************#
columns_tbl_intermediary = {
    '__tablename__': 'tbl_intermediary',
    'organisation_id': common_columns.get('integer_not_nullable')(),
    'intermediary_id_manager': common_columns.get('integer_not_nullable')(),
    'pay_level': common_columns.get('boolean_default_false')(),
    'from_date': common_columns.get('date')(),
    'to_date': common_columns.get('date')(),
}
Intermediary = get_phat_table(model_name='Intermediary', columndict=columns_tbl_intermediary)

columns_tbl_intermediary_role = {
    '__tablename__': 'tbl_intermediary_role',
    'name': common_columns.get('description_not_nullable')(),
    'description': common_columns.get('description_not_nullable')(),
}
IntermediaryRole = get_phat_table(model_name='IntermediaryRole', columndict=columns_tbl_intermediary_role)

columns_tbl_intermediary_campaign_link = {
    '__tablename__': 'tbl_intermediary_campaign_link',
    'intermediary_id': common_columns.get('integer_not_nullable')(),
    'campaign_id': common_columns.get('integer_not_nullable')(),
}
IntermediaryCampaignLink = get_phat_table(model_name='IntermediaryCampaignLink', columndict=columns_tbl_intermediary_campaign_link)

columns_tbl_intermediary_role_link = {
    '__tablename__': 'tbl_intermediary_role_link',
    'intermediary_id': common_columns.get('integer_not_nullable')(),
    'intermediary_role_id': common_columns.get('integer_not_nullable')(),
}
IntermediaryRoleLink = get_phat_table(model_name='IntermediaryRoleLink', columndict=columns_tbl_intermediary_role_link)

